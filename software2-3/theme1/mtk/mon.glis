68K GAS  mon.s 			page 1


   1               	***************************************************************
   2               	** „Çπ„Çø„ÉÉ„ÇØÈ†òÂüü„ÅÆÁ¢∫‰øù
   3               	***************************************************************
   4               	.extern 	start
   5               	.global 	monitor_begin
   6               	.include	"equdefs.inc"
   1               	***********************************************
   2               	** Â§âÊï∞„ÅÆÂÆöÁæ©
   3               	***********************************************
   4               	
   5               	***************************************************************
   6               	** ÂêÑÁ®Æ„É¨„Ç∏„Çπ„ÇøÂÆöÁæ©
   7               	***************************************************************
   8               	***************
   9               	** „É¨„Ç∏„Çπ„ÇøÁæ§„ÅÆÂÖàÈ†≠
  10               	***************
  11               	.equ REGBASE, 	0xFFF000 	| DMAP „Çí‰ΩøÁî®Ôºé
  12               	.equ IOBASE, 	0x00d00000
  13               		
  14               	***************
  15               	** Ââ≤„ÇäËæº„ÅøÈñ¢‰øÇ„ÅÆ„É¨„Ç∏„Çπ„Çø
  16               	***************
  17               	.equ IVR, REGBASE+0x300 	| Ââ≤„ÇäËæº„Åø„Éô„ÇØ„Çø„É¨„Ç∏„Çπ„Çø
  18               	.equ IMR, REGBASE+0x304 	| Ââ≤„ÇäËæº„Åø„Éû„Çπ„ÇØ„É¨„Ç∏„Çπ„Çø
  19               	.equ ISR, REGBASE+0x30c 	| Ââ≤„ÇäËæº„Åø„Çπ„ÉÜ„Éº„Çø„Çπ„É¨„Ç∏„Çπ„Çø
  20               	.equ IPR, REGBASE+0x310 	| Ââ≤„ÇäËæº„Åø„Éö„É≥„Éá„Ç£„É≥„Ç∞„É¨„Ç∏„Çπ„Çø
  21               		
  22               	***************
  23               	** „Çø„Ç§„ÉûÈñ¢‰øÇ„ÅÆ„É¨„Ç∏„Çπ„Çø
  24               	***************
  25               	.equ TCTL1, 	REGBASE+0x600 	| „Çø„Ç§„ÉûÔºë„Ç≥„É≥„Éà„É≠„Éº„É´„É¨„Ç∏„Çπ„Çø
  26               	.equ TPRER1, 	REGBASE+0x602 	| „Çø„Ç§„ÉûÔºë„Éó„É™„Çπ„Ç±„Éº„É©„É¨„Ç∏„Çπ„Çø
  27               	.equ TCMP1, 	REGBASE+0x604 	| „Çø„Ç§„ÉûÔºë„Ç≥„É≥„Éö„Ç¢„É¨„Ç∏„Çπ„Çø
  28               	.equ TCN1, 	REGBASE+0x608 	| „Çø„Ç§„ÉûÔºë„Ç´„Ç¶„É≥„Çø„É¨„Ç∏„Çπ„Çø
  29               	.equ TSTAT1, 	REGBASE+0x60a 	| „Çø„Ç§„ÉûÔºë„Çπ„ÉÜ„Éº„Çø„Çπ„É¨„Ç∏„Çπ„Çø
  30               		
  31               	***************
  32               	** UART1ÔºàÈÄÅÂèó‰ø°ÔºâÈñ¢‰øÇ„ÅÆ„É¨„Ç∏„Çπ„Çø
  33               	***************
  34               	.equ USTCNT1, 	REGBASE+0x900 	| UART1 „Çπ„ÉÜ„Éº„Çø„Çπ/„Ç≥„É≥„Éà„É≠„Éº„É´„É¨„Ç∏„Çπ„Çø
  35               	.equ UBAUD1, 	REGBASE+0x902 	| UART1 „Éú„Éº„Ç≥„É≥„Éà„É≠„Éº„É´„É¨„Ç∏„Çπ„Çø
  36               	.equ URX1, 	REGBASE+0x904 	| UART1 Âèó‰ø°„É¨„Ç∏„Çπ„Çø
  37               	.equ UTX1, 	REGBASE+0x906 	| UART1 ÈÄÅ‰ø°„É¨„Ç∏„Çπ„Çø
  38               		
  39               	***************
  40               	** LED
  41               	***************
  42               	.equ LED7, IOBASE+0x000002f
  43               	.equ LED6, IOBASE+0x000002d
  44               	.equ LED5, IOBASE+0x000002b
  45               	.equ LED4, IOBASE+0x0000029
  46               	.equ LED3, IOBASE+0x000003f
  47               	.equ LED2, IOBASE+0x000003d
  48               	.equ LED1, IOBASE+0x000003b
  49               	.equ LED0, IOBASE+0x0000039
  50               	
  51               	***************
68K GAS  mon.s 			page 2


  52               	** „Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Áï™Âè∑
  53               	***************
  54               	.equ SYSCALL_NUM_GETSTRING, 	1
  55               	.equ SYSCALL_NUM_PUTSTRING, 	2
  56               	.equ SYSCALL_NUM_RESET_TIMER, 	3
  57               	.equ SYSCALL_NUM_SET_TIMER, 	4
  58               	
  59               	****************************************************************
  60               	*** ÂàùÊúüÂÄ§„ÅÆ„ÅÇ„Çã„Éá„Éº„ÇøÈ†òÂüü
  61               	****************************************************************
  62               	.section .data
  63               	
  64               	.even 				| \n: Ê¨°„ÅÆË°å„Å∏ („É©„Ç§„É≥„Éï„Ç£„Éº„Éâ)
  65 0000 0000      	TTC:	.dc.w 0
  66               	.even
  67               		
  68               	****************************************************************
  69               	*** ÂàùÊúüÂÄ§„ÅÆÁÑ°„ÅÑ„Éá„Éº„ÇøÈ†òÂüü
  70               	****************************************************************
  71               	.section .bss
  72 0000 0000 0000 	BUF: .ds.b 256 			| BUF[256]
  72      0000 0000 
  72      0000 0000 
  72      0000 0000 
  72      0000 0000 
  73               	
  74               	.even
  75 0100 0000 0000 	USR_STK: .ds.b 0x4000 		| „É¶„Éº„Ç∂„Çπ„Çø„ÉÉ„ÇØÈ†òÂüü
  75      0000 0000 
  75      0000 0000 
  75      0000 0000 
  75      0000 0000 
  76               	.even
  77               	USR_STK_TOP: 			| „É¶„Éº„Ç∂„Çπ„Çø„ÉÉ„ÇØÈ†òÂüü„ÅÆÊúÄÂæåÂ∞æ
  78               		
  79               	*******************************
  80               	.section .bss
  81 4100 0000 0000 	Queue0:		.ds.b	274	/* Âèó‰ø°Áî®„Ç≠„É•„Éº */
  81      0000 0000 
  81      0000 0000 
  81      0000 0000 
  81      0000 0000 
  82 4212 0000 0000 	Queue1:		.ds.b	274	/* ÈÄÅ‰ø°Áî®„Ç≠„É•„Éº */
  82      0000 0000 
  82      0000 0000 
  82      0000 0000 
  82      0000 0000 
  83               	
  84               	.section .text
  85               	.equ	BF_START, 	0		/* „Ç≠„É•„Éº„ÅÆ„Éá„Éº„ÇøÈ†òÂüü„ÅÆÂÖàÈ†≠ */
  86               	.equ	BF_END, 	255		/* „Ç≠„É•„Éº„ÅÆ„Éá„Éº„ÇøÈ†òÂüü„ÅÆÊúÄÂæåÂ∞æ */
  87               	.equ	top, 		256		/* „Ç≠„É•„Éº„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ„Çí‰øùÊåÅ„Å∏„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà */
  88               	.equ	out, 		260		/* Ê¨°„Å´pop„Åô„Çã„Éá„Éº„Çø„Ç¢„Éâ„É¨„Çπ„Çí‰øùÊåÅ„Å∏„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà */
  89               	.equ	in, 		264		/* Ê¨°„Å´in„Åô„Çã„Éá„Éº„Çø„Ç¢„Éâ„É¨„Çπ„Çí‰øùÊåÅ„Å∏„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà */
  90               	.equ	bottom, 	268		/* „Ç≠„É•„Éº„ÅÆÊúÄÁµÇ„Ç¢„Éâ„É¨„Çπ„Çí‰øùÊåÅ„Å∏„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà */
  91               	.equ	s, 		272		/* „Ç≠„É•„ÉºÂÜÖ„ÅÆË¶ÅÁ¥†Êï∞„Çí‰øùÊåÅ„Åô„ÇãÂ§âÊï∞„Å∏„ÅÆ„Ç™„Éï„Çª„ÉÉ„Éà */
  92               	
68K GAS  mon.s 			page 3


  93               	
  94               	
   7               	
   8               	monitor_begin:
   9               	
  10               	.section .bss
  11               	.even
  12 4324 0000 0000 	SYS_STK: .ds.b 0x4000 	| „Ç∑„Çπ„ÉÜ„É†„Çπ„Çø„ÉÉ„ÇØÈ†òÂüü
  12      0000 0000 
  12      0000 0000 
  12      0000 0000 
  12      0000 0000 
  13               	
  14               	.even
  15               	SYS_STK_TOP: 		| „Ç∑„Çπ„ÉÜ„É†„Çπ„Çø„ÉÉ„ÇØÈ†òÂüü„ÅÆÊúÄÂæåÂ∞æ
  16               	
  17               	.even
  18 8324 0000 0000 	task_p:	.ds.l 1
  19               	
  20               	***************************************************************
  21               	** ÂàùÊúüÂåñ
  22               	***************************************************************
  23               	.section .text
  24               	.even
  25               	
  26               	
  27               	boot:   ***************************************************
  28               		** „Çπ„Éº„Éë„Éº„Éê„Ç§„Ç∂ & ÂêÑÁ®ÆË®≠ÂÆö„ÇíË°å„Å£„Å¶„ÅÑ„ÇãÊúÄ‰∏≠„ÅÆÂâ≤ËæºÁ¶ÅÊ≠¢
  29               		***************************************************
  30 0000 46FC 2700 		move.w 	#0x2700,%SR
  31 0004 4FF9 0000 		lea.l	SYS_STK_TOP, %SP | Set SSP
  31      0000 
  32               		
  33               		******************************
  34               		** Ââ≤„ÇäËæº„Åø„Ç≥„É≥„Éà„É≠„Éº„É©„ÅÆÂàùÊúüÂåñ
  35               		*****************************
  36 000a 13FC 0040 		move.b 	#0x40, IVR | „É¶„Éº„Ç∂Ââ≤„ÇäËæº„Åø„Éô„ÇØ„ÇøÁï™Âè∑„Çí0x40+level „Å´Ë®≠ÂÆöÔºé
  36      00FF F300 
  37 0012 23FC 00FF 		move.l 	#0x00ff3ffb,IMR | ÂÖ®Ââ≤„ÇäËæº„Åø„Éû„Çπ„ÇØ
  37      3FFB 00FF 
  37      F304 
  38               		
  39               		******************************************************************
  40               		** ÈÄÅÂèó‰ø° (UART1) Èñ¢‰øÇ„ÅÆÂàùÊúüÂåñ (Ââ≤„ÇäËæº„Åø„É¨„Éô„É´„ÅØ 4 „Å´Âõ∫ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã)
  41               		*****************************************************************
  42 001c 33FC E10C 		move.w 	#0xe10c, USTCNT1 
  42      00FF F900 
  43 0024 33FC 0038 		move.w 	#0x0038, UBAUD1 | baud rate = 230400 bps
  43      00FF F902 
  44               		
  45               		*********************************************************
  46               		** „Çø„Ç§„ÉûÈñ¢‰øÇ„ÅÆÂàùÊúüÂåñ (Ââ≤„ÇäËæº„Åø„É¨„Éô„É´„ÅØ 6 „Å´Âõ∫ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã)
  47               		*********************************************************
  48 002c 33FC 0004 		move.w 	#0x0004, TCTL1 
  48      00FF F600 
  49               	
  50 0034 21FC 0000 		move.l 	#uart1_interrupt, 0x110
68K GAS  mon.s 			page 4


  50      0000 0110 
  51 003c 21FC 0000 		move.l 	#timer_interrupt, 0x118
  51      0000 0118 
  52               	
  53               		***************
  54               		**„Ç≠„É•„Éº„ÅÆÂàùÊúüÂåñ
  55               		***************
  56 0044 4EBA 00D2 		jsr 	Init_Q
  57               		
  58 0048 21FC 0000 		move.l	#SYSTEM_CALL,0x080
  58      0000 0080 
  59 0050 23FC 000F 		move.l	#0x00f3ff9, IMR
  59      3FF9 00FF 
  59      F304 
  60               		
  61               		
  62 005a 46FC 0000 		move.w	#0x0000, %SR
  63 005e 4EF9 0000 		jmp	start
  63      0000 
  64               		
  65               	
  66               	
  67               	**************************
  68               	**ÈÄÅÂèó‰ø°Ââ≤„ÇäËæº„Åø„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ
  69               	**************************
  70               		
  71               	uart1_interrupt:
  72 0064 48E7 F000 		movem.l %d0-%d3, -(%sp)      		/* „É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø */
  73 0068 3039 00FF 		move.w 	UTX1, %d0			/* UTX„ÅÆ15„Éì„ÉÉ„ÉàÁõÆ„Åå1„Åã„Å©„ÅÜ„ÅãË¶ã„Çã */
  73      F906 
  74 006e 0280 0000 		andi.l 	#0x8000, %d0
  74      8000 
  75 0074 6700 0008 		beq 	uart1_interrupt_receive		/* 1‰ª•Â§ñ„Å™„ÇâÂàÜÂ≤ê */
  76 0078 7200      		move.l 	#0, %d1				/* ch=0 */
  77 007a 4EBA 01A8 		jsr 	INTERPUT			/* 1„Å™„ÇâÈÄÅ‰ø°Ââ≤„ÇäËæº„Åø */
  78               		
  79               	uart1_interrupt_receive:
  80 007e 3639 00FF 		move.w 	URX1, %d3			/* URX„ÅÆ13„Éì„ÉÉ„ÉàÁõÆ„Åå1„Åã„Å©„ÅÜ„ÅãË¶ã„Çã */
  80      F904 
  81 0084 1403      		move.b	%d3, %d2			/* D3„ÅÆ‰∏ã‰Ωç8bit(„Éá„Éº„ÇøÈÉ®ÂàÜ)„ÇíD2.B„Å´„Ç≥„Éî„Éº */
  82 0086 0283 0000 		andi.l	#0x2000, %d3
  82      2000 
  83 008c 6700 0008 		beq	uart1_interrupt_end		/* 1‰ª•Â§ñ„Å™„ÇâÂàÜÂ≤ê */
  84 0090 7200      		move.l 	#0, %d1				/* ch=0 */
  85 0092 4EBA 0212 		jsr 	INTERGET			/* 1„Å™„ÇâÂèó‰ø°Ââ≤„ÇäËæº„Åø */
  86               		
  87               	uart1_interrupt_end:	
  88 0096 4CDF 000F 		movem.l (%sp)+, %d0-%d3			/* „É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ© */
  89 009a 4E73      		rte					/* Âëº„Å≥Âá∫„ÅóÂÖÉ„Å´Êàª„Çã */
  90               	
  91               		
  92               	
  93               	***************************************
  94               	** „Çø„Ç§„ÉûÁî®„Éè„Éº„ÉâÂâ≤„ÇäËæº„Åø„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ
  95               	***************************************
  96               	timer_interrupt:
  97 009c 3039 00FF 	    move.w 	TSTAT1, %d0        	/*TSTAT„Çíd0„É¨„Ç∏„Çπ„Çø„Å´Ë™≠„ÅøËæº„Åø*/
68K GAS  mon.s 			page 5


  97      F60A 
  98 00a2 0240 0001 	    andi.w	#0x01, %d0
  99 00a6 0C40 0000 	    cmpi.w	#0, %d0			/*Á¨¨0„Éì„ÉÉ„Éà„ÇíÁ¢∫Ë™çÔºà1„Å™„Çâ„Å∞Ââ≤„ÇäËæº„ÅøÁô∫ÁîüÔºâ*/
 100 00aa 6700 000E 	    beq     	timer_interrupt_end	/*0„Å™„Çâ„Å∞Ââ≤„ÇäËæº„ÅøÂá¶ÁêÜ„ÇíÁµÇ‰∫Ü*/
 101 00ae 33FC 0000 	    move.w  	#0, TSTAT1        	/*TSTAT„Çí„É™„Çª„ÉÉ„Éà*/
 101      00FF F60A 
 102 00b6 4EBA 026C 	    jsr     	CALL_RP           	/*Ââ≤„ÇäËæº„ÅøÊôÇ„Å´Âëº„Å≥Âá∫„Åô„É´„Éº„ÉÅ„É≥„ÇíÂÆüË°å*/
 103               	timer_interrupt_end:
 104 00ba 4E73      	    rte                       		/*Ââ≤„ÇäËæº„ÅøÁµÇ‰∫Ü*/
 105               	    
 106               	    
 107               	****************************
 108               	** SYSTEM_CALL
 109               	** ÂÖ•Âäõ
 110               	** d0:„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Áï™Âè∑
 111               	** d1‰ª•Èôç:„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´„ÅÆÂºïÊï∞
 112               	** Âá∫Âäõ
 113               	** d0:„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Âëº„Å≥Âá∫„Åó„ÅÆÁµêÊûú
 114               	****************************
 115               	
 116               	SYSTEM_CALL:
 117 00bc 0C80 0000 		cmp.l   #5, %d0
 117      0005 
 118 00c2 6600 0006 		bne 	SYSTEM_CALL1
 119 00c6 4EBA 026E 		jsr 	skipmt
 120               	
 121               	SYSTEM_CALL1:
 122 00ca 48E7 7000 		movem.l	%d1-%d3,-(%sp)		/*„É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø*/
 123 00ce 0C80 0000 		cmp.l	#1,%d0
 123      0001 
 124 00d4 6600 000A 		bne	SYSTEM_CALL2		/*„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Áï™Âè∑„ÅåÔºë„Åß„Å™„ÅÑ„Å™„Çâ„Å∞ÂàÜÂ≤ê*/
 125 00d8 4EBA 01E6 		jsr	GETSTRING		/*GETSTRING„ÇíÂëº„Å≥Âá∫„Åô*/
 126 00dc 6000 0034 		bra	SYSTEM_CALL_FINISH
 127               		
 128               	SYSTEM_CALL2:
 129 00e0 0C80 0000 		cmp.l	#2,%d0
 129      0002 
 130 00e6 6600 000A 		bne	SYSTEM_CALL3		/*„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Áï™Âè∑„Åå2„Åß„Å™„ÅÑ„Å™„Çâ„Å∞ÂàÜÂ≤ê*/
 131 00ea 4EBA 0176 		jsr	PUTSTRING		/*PUTSTRING„ÇíÂëº„Å≥Âá∫„Åô*/
 132 00ee 6000 0022 		bra	SYSTEM_CALL_FINISH
 133               	
 134               	SYSTEM_CALL3:
 135 00f2 0C80 0000 		cmp.l	#3,%d0
 135      0003 
 136 00f8 6600 000A 		bne	SYSTEM_CALL4		/*„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Áï™Âè∑„Åå3„Åß„Å™„ÅÑ„Å™„Çâ„Å∞ÂàÜÂ≤ê*/
 137 00fc 4EBA 01F6 		jsr	RESET_TIMER		/*RESET_TIMER„ÇíÂëº„Å≥Âá∫„Åô*/
 138 0100 6000 0010 		bra	SYSTEM_CALL_FINISH
 139               	
 140               	SYSTEM_CALL4:
 141 0104 0C80 0000 		cmp.l	#4,%d0
 141      0004 
 142 010a 6600 0006 		bne	SYSTEM_CALL_FINISH	/*„Ç∑„Çπ„ÉÜ„É†„Ç≥„Éº„É´Áï™Âè∑„Åå4„Åß„Å™„ÅÑ„Å™„Çâ„Å∞ÂàÜÂ≤ê*/
 143 010e 4EBA 01EE 		jsr	SET_TIMER		/*SET_TIMER„ÇíÂëº„Å≥Âá∫„Åô*/
 144               	
 145               	SYSTEM_CALL_FINISH:
 146 0112 4CDF 000E 		movem.l	(%sp)+,%d1-%d3		/*„É¨„Ç∏„Çπ„Çø„ÅÆÂæ©Â∏∞*/
 147 0116 4E73      		rte
68K GAS  mon.s 			page 6


 148               	    
 149               	    
 150               	***************************
 151               	**„Ç≠„É•„Éº„ÅÆÂàùÊúüÂåñÂá¶ÁêÜ
 152               	***************************
 153               	Init_Q:
 154 0118 4EBA 0008 		jsr 	Init_Q0			/* Âèó‰ø°Áî®„Ç≠„É•„Éº„ÇíÂàùÊúüÂåñ */
 155 011c 4EBA 002A 		jsr 	Init_Q1			/* ÈÄÅ‰ø°Áî®„Ç≠„É•„Éº„ÇíÂàùÊúüÂåñ */
 156 0120 4E75      		rts				/* Âëº„Å≥Âá∫„ÅóÂÖÉ„Å´Âæ©Â∏∞ */
 157               	
 158               	Init_Q0:
 159 0122 43F9 0000 		lea.l	Queue0, %a1		/* Queue0È†òÂüü„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ -> A1*/
 159      0000 
 160 0128 2449      		move.l	%a1, %a2		/* Queue0„ÅÆ„Éê„ÉÉ„Éï„Ç°„ÅÆÊúÄÁµÇ„Ç¢„Éâ„É¨„Çπ -> A2*/
 161 012a D5FC 0000 		add.l	#BF_END, %a2		
 161      00FF 
 162 0130 2349 0100 		move.l	%a1, top(%a1)		/* top„ÇíÂàùÊúüÂåñ */
 163 0134 2349 0104 		move.l	%a1, out(%a1)		/* out„ÇíÂàùÊúüÂåñ */
 164 0138 2349 0108 		move.l	%a1, in(%a1)		/* in„ÇíÂàùÊúüÂåñ */
 165 013c 234A 010C 		move.l	%a2, bottom(%a1)	/* bottom„ÇíÂàùÊúüÂåñ */
 166 0140 137C 0000 		move.b	#0x00, s(%a1)		/* s„ÇíÂàùÊúüÂåñ */
 166      0110 
 167 0146 4E75      		rts
 168               	
 169               	Init_Q1:	/* Q0„Å®ÂêåÊßò„Å´Q1„ÇíÂàùÊúüÂåñ */
 170 0148 43F9 0000 		lea.l	Queue1, %a1
 170      0000 
 171 014e 2449      		move.l	%a1, %a2
 172 0150 D5FC 0000 		add.l	#BF_END, %a2
 172      00FF 
 173 0156 2349 0100 		move.l	%a1, top(%a1)
 174 015a 2349 0104 		move.l	%a1, out(%a1)
 175 015e 2349 0108 		move.l	%a1, in(%a1)
 176 0162 234A 010C 		move.l	%a2, bottom(%a1)
 177 0166 137C 0000 		move.b	#0x00, s(%a1)
 177      0110 
 178 016c 4E75      		rts
 179               	
 180               	****************************
 181               	** SelectQueue
 182               	** ÂÖ•Âäõ
 183               	** d0: Âèó‰ø°(0)or ÈÄÅ‰ø°(1)
 184               	** Âá∫Âäõ
 185               	** a1: ÈÅ∏Êäû„Åó„Åü„Ç≠„É•„Éº„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ
 186               	****************************
 187               	SelectQueue:
 188 016e 227C 0000 		movea.l	#Queue0,%a1		/* d0„Åå0„Å™„Çâ#Queue0 -> a1 */
 188      0000 
 189 0174 0C40 0000 		cmp	#0, %d0				
 190 0178 6700 0008 		beq	End_SelectQueue
 191 017c 227C 0000 		movea.l	#Queue1,%a1		/* d0„Åå1„Å™„Çâ#Queue1 -> a1 */
 191      0000 
 192               	End_SelectQueue:
 193 0182 4E75      		rts				/* Âëº„Å≥Âá∫„ÅóÂÖÉ„Å´Âæ©Â∏∞ */	
 194               	
 195               	*************************
 196               	** INQ
68K GAS  mon.s 			page 7


 197               	** „Ç≠„É•„Éº„Å´Ë¶ÅÁ¥†„ÇíÂÖ•„Çå„Çã
 198               	*************************	
 199               	INQ:
 200 0184 40E7      		move.w	 %SR, -(%sp)		/* ÁèæËµ∞Ë°å„É¨„Éô„É´„ÅÆÈÄÄÈÅø */
 201 0186 46FC 2700 		move.w	#0x2700, %SR		/* Ââ≤„ÇäËæº„ÅøÁ¶ÅÊ≠¢Ôºà=Ëµ∞Ë°å„É¨„Éô„É´„Çí7„Å´Ôºâ*/
 202 018a 48E7 20F0 		movem.l	%a0-%a3/%d2, -(%sp)	/*„É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø*/
 203 018e 4EBA FFDE 		jsr	SelectQueue		/*SelectQueue„ÅßÁ∑®ÈõÜ„Åô„Çã„Ç≠„É•„Éº„ÅÆÂÖàÈ†≠„Çía1„Å∏*/
 204 0192 7000      		move.l	#0, %d0			/*D0„ÅØPUT_BUFÂÜÖ„ÅßÂ§±ÊïóÂà§ÂÆö„Å´‰ΩøÁî®*/
 205 0194 4EBA 0026 		jsr	PUT_BUF			/* PUT_BUF„ÅÆÂëº„Å≥Âá∫„Åó */
 206 0198 4CDF 0F04 		movem.l	(%sp)+, %a0-%a3/%d2	/*„É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ©*/
 207 019c 46DF      		move.w 	(%sp)+, %SR		/* Ëµ∞Ë°å„É¨„Éô„É´„ÅÆÂõûÂæ© */
 208 019e 4E75      		rts				/* Ââ≤„ÇäËæº„ÅøÁµÇ‰∫Ü */
 209               	
 210               	*************************
 211               	** OUTQ
 212               	** „Ç≠„É•„Éº„Åã„ÇâË¶ÅÁ¥†„ÇíÂèñ„ÇäÂá∫„Åô
 213               	** ÂÖ•Âäõ
 214               	** d0: Âèó‰ø°(0)or ÈÄÅ‰ø°(1) for SelectQueue
 215               	*************************
 216               	OUTQ:
 217 01a0 40E7      		move.w 	%SR, -(%sp)		/* ÁèæËµ∞Ë°å„É¨„Éô„É´„ÅÆÈÄÄÈÅø */
 218 01a2 46FC 2700 		move.w	#0x2700, %SR		/* Ââ≤„ÇäËæº„ÅøÁ¶ÅÊ≠¢Ôºà=Ëµ∞Ë°å„É¨„Éô„É´„Çí7„Å´Ôºâ*/
 219 01a6 48E7 20F0 		movem.l	%a0-%a3/%d2, -(%sp)	/*„É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø*/
 220 01aa 4EBA FFC2 		jsr	SelectQueue		/*SelectQueue„ÅßÁ∑®ÈõÜ„Åô„Çã„Ç≠„É•„Éº„ÅÆÂÖàÈ†≠„Çía1„Å∏*/
 221 01ae 7000      		move.l	#0, %d0			/* D0„ÅØGET_BUFÂÜÖ„ÅßÂ§±ÊïóÂà§ÂÆö„Å´‰ΩøÁî®*/
 222 01b0 4EBA 003E 		jsr	GET_BUF			/* GET_BUF„ÅÆÂëº„Å≥Âá∫„Åó */
 223 01b4 4CDF 0F04 		movem.l	(%sp)+, %a0-%a3/%d2	/*„É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ©*/
 224 01b8 46DF      		move.w 	(%sp)+, %SR		/* Ëµ∞Ë°å„É¨„Éô„É´„ÅÆÂõûÂæ© */
 225 01ba 4E75      		rts				/* Ââ≤„ÇäËæº„ÅøÁµÇ‰∫Ü */
 226               	
 227               	*************************
 228               	** PUT_BUF
 229               	** ÂÖ•Âäõ
 230               	** a1: „Ç≠„É•„Éº„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ
 231               	** a2: ÊØîËºÉÁî®„Ç¢„Éâ„É¨„Çπ„É¨„Ç∏„Çπ„Çø
 232               	** a3: „Ç≠„É•„ÉºÂÜÖ„Éá„Éº„Çø„ÅÆÊ†ºÁ¥çÂÖà„Ç¢„Éâ„É¨„Çπ
 233               	** d1: „Ç≠„É•„Éº„Å´Ê†ºÁ¥ç„Åô„Çã„Éá„Éº„Çø
 234               	*************************
 235               	PUT_BUF:
 236 01bc 3429 0110 		move	s(%a1), %d2		/* Ë¶ÅÁ¥†Êï∞ -> d2 */
 237 01c0 0C42 0100 		cmp	 #0x100, %d2		/* „Ç≠„É•„Éº„ÅåÊ∫ÄÊùØ„Å™„Çâ‰Ωï„ÇÇ„Åõ„ÅöÂæ©Â∏∞ */
 238 01c4 6700 0028 		beq	END_PUT_BUF
 239 01c8 2669 0108 		movea.l in(%a1), %a3		/* „Ç≠„É•„Éº„Å´„Éá„Éº„Çø„ÇíÊ†ºÁ¥ç  */
 240 01cc 1681      		move.b	%d1, (%a3)
 241 01ce 2469 010C 		movea.l	bottom(%a1), %a2	/* Ê†ºÁ¥çÂÖà„Åå„Éá„Éº„ÇøÈ†òÂüü„ÅÆÊúÄÂæå„Å™„ÇâÂÖàÈ†≠„Å∏ */
 242 01d2 B5E9 0108 		cmpa.l	in(%a1), %a2
 243 01d6 6700 000A 		beq	STEP1_PUT_BUF
 244 01da 52A9 0108 		add.l	#1, in(%a1)		/* „Åù„ÅÜ„Åß„Å™„ÅÑ„Å™„ÇâÂçò„Å´Ê¨°„Å∏ÈÄ≤„ÇÅ„Çã */
 245 01de 6000 0008 		bra	STEP2_PUT_BUF
 246               	
 247               	STEP1_PUT_BUF:
 248 01e2 2369 0100 		move.l	top(%a1), in(%a1)
 248      0108 
 249               	
 250               	STEP2_PUT_BUF:
 251 01e8 5269 0110 		addq	#1, s(%a1)		/* Ë¶ÅÁ¥†Êï∞ s = +1 */
 252 01ec 7001      		move.l	#1, %d0			/* Êõ∏„ÅçËæº„ÅøÊàêÂäü */
68K GAS  mon.s 			page 8


 253               	
 254               	END_PUT_BUF:	
 255 01ee 4E75      		rts				/* Âëº„Å≥Âá∫„ÅóÂÖÉ„Å∏„ÅÆÂæ©Â∏∞ */
 256               		
 257               	****************************
 258               	** GET_BUF
 259               	** a1: „Ç≠„É•„Éº„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ
 260               	** a2: ÊØîËºÉÁî®„Ç¢„Éâ„É¨„Çπ„É¨„Ç∏„Çπ„Çø
 261               	** a3: „Ç≠„É•„ÉºÂÜÖ„Éá„Éº„Çø„ÅÆË™≠„ÅøÂá∫„ÅóÂÖÉ„Ç¢„Éâ„É¨„Çπ
 262               	***************************	
 263               	GET_BUF:
 264 01f0 3429 0110 		move	s(%a1), %d2		/* „Ç≠„É•„Éº„ÅåÁ©∫„Åã„Å©„ÅÜ„ÅãÁ¢∫Ë™ç */
 265 01f4 0C42 0000 		cmp	#0x0, %d2
 266 01f8 6700 0028 		beq	END_GET_BUF		/* „Ç≠„É•„Éº„ÅåÁ©∫„Å™„Çâ‰Ωï„ÇÇ„Åõ„ÅöÂæ©Â∏∞ */
 267 01fc 2669 0104 		movea.l out(%a1), %a3		/* „Ç≠„É•„Éº„Åã„ÇâÂèñ„ÇäÂá∫„Åó„Åü„Éá„Éº„Çø -> d1 */
 268 0200 1213      		move.b	(%a3), %d1			
 269 0202 2469 010C 		movea.l	bottom(%a1), %a2	/* „Ç≠„É•„ÉºÈ†òÂüü„ÅÆÊúÄÂæå„Åã„Çâ„Éá„Éº„Çø„ÇíÂèñ„ÇäÂá∫„Åó„Åü„ÇâÊ¨°„ÅÆÂèñ„
 270 0206 B5E9 0104 		cmpa.l	out(%a1), %a2
 271 020a 6700 000A 		beq	STEP1_GET_BUF
 272 020e 52A9 0104 		add.l	#1, out(%a1)		/* „Åù„ÅÜ„Åß„Å™„ÅÑ„Å™„ÇâÂçò„Å´Ê¨°„Å∏ÈÄ≤„ÇÅ„Çã */
 273 0212 6000 0008 		bra	STEP2_GET_BUF
 274               	
 275               	STEP1_GET_BUF:
 276 0216 2369 0100 		move.l	top(%a1), out(%a1)
 276      0104 
 277               	
 278               	
 279               	STEP2_GET_BUF:
 280 021c 5369 0110 		subq	#1, s(%a1)		/* Ë¶ÅÁ¥†Êï∞ s = -1 */
 281 0220 7001      		move.l	#1, %d0			/* Êõ∏„ÅçËæº„ÅøÊàêÂäü */
 282               	
 283               	END_GET_BUF:	
 284 0222 4E75      		rts				/* Âëº„Å≥Âá∫„ÅóÂÖÉ„Å∏„ÅÆÂæ©Â∏∞ */
 285               	
 286               	**********************
 287               	** INTERPUT
 288               	** ÂÖ•Âäõ: ch ->„ÄÄd1
 289               	**********************
 290               	INTERPUT:
 291 0224 48E7 00F0 		movem.l %a0-%a3, -(%sp)		/* „É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø */
 292 0228 40E7      		move.w 	%SR, -(%sp)
 293 022a 46FC 2700 		move.w 	#0x2700, %SR		/*Ëµ∞Ë°å„É¨„Éô„É´7„Å´Ë®≠ÂÆö*/
 294               	
 295 022e 0C01 0000 		cmpi.b 	#0, %d1
 296 0232 6600 0026 		bne 	END_INTERPUT		/*ch!=0„Å™„Çâ‰Ωï„ÇÇ„Åõ„ÅöÂæ©Â∏∞*/
 297               	
 298 0236 7001      		moveq.l #1, %d0
 299 0238 4EBA FF66 		jsr 	OUTQ			/*OUTQ(1,%d1)„ÇíÂÆüË°å*/
 300               		
 301 023c 0C00 0000 		cmpi.b 	#0, %d0
 302 0240 6600 000E 		bne 	OUTQ_FAIL		/*OUTQ„ÅåÂ§±Êïó„Å™„ÇâÈÄÅ‰ø°Ââ≤„ÇäËæº„Åø„Çí„Éû„Çπ„ÇØ*/
 303               	
 304 0244 33FC E108 		move.w 	#0xe108, USTCNT1	/*ÈÄÅ‰ø°Ââ≤„ÇäËæº„Åø„Çí„Éû„Çπ„ÇØ*/
 304      00FF F900 
 305 024c 6000 000C 		bra 	END_INTERPUT
 306               	
 307               	OUTQ_FAIL:
68K GAS  mon.s 			page 9


 308 0250 0641 0800 		add.w 	#0x800, %d1		/*„Éò„ÉÉ„ÉÄ‰ªò‰∏é*/
 309 0254 33C1 00FF 		move.w 	%d1, UTX1		/*UTX1„Å´ÈÄÅ‰ø°*/
 309      F906 
 310               	
 311               	END_INTERPUT:
 312 025a 46DF      		move.w 	(%sp)+, %SR		/* „É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ© */
 313 025c 4CDF 0F00 		movem.l (%sp)+, %a0-%a3
 314 0260 4E75      		rts				/* Ââ≤„ÇäËæº„ÅøÁµÇ‰∫Ü */
 315               	
 316               	
 317               	******************
 318               	**PUTSTRING
 319               	** ÂÖ•Âäõ:
 320               	**	ch ->„ÄÄd1
 321               	**	p  ->„ÄÄd2
 322               	**	size ->„ÄÄd3
 323               	** Âá∫Âäõ:
 324               	**	ÂÆüÈöõÈÄÅ‰ø°„Åó„Åü„Éá„Éº„ÇøÊï∞->d0 
 325               	******************
 326               	
 327               	PUTSTRING:
 328 0262 48E7 7880 		movem.l %d1-%d4/%a0, -(%sp)		/* „É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø */
 329 0266 0C01 0000 		cmpi.b 	#0, %d1				/* ch„Åå0‰ª•Â§ñ„Å™„Çâ‰Ωï„ÇÇ„Åõ„ÅöÂæ©Â∏∞ */
 330 026a 6600 0034 		bne 	END_PUTSTRING
 331 026e 7800      		move.l	#0, %d4				/* %d4„ÇíÂÆüÈöõÈÄÅ‰ø°„Åó„Åü„Éá„Éº„ÇøÊï∞„ÅÆ„Ç´„Ç¶„É≥„Çø„Å®„Åó„Å¶‰ΩøÁî® */
 332 0270 2042      		move.l 	%d2, %a0			/* p„Çía0„Å´„Ç≥„Éî„Éº */
 333 0272 0C03 0000 		cmpi.b 	#0, %d3				/* size=0„Å™„Çâ d0=0 „Å´„Åó„Å¶Âæ©Â∏∞ */
 334 0276 6700 0026 		beq 	PUTSTRING_STEP3
 335               	
 336               	PUTSTRING_STEP1:
 337 027a B644      		cmp 	%d4, %d3			/* „Ç´„Ç¶„É≥„Çø„Å®size„ÇíÊØîËºÉ */
 338 027c 6700 0018 		beq 	PUTSTRING_STEP2			/* „Ç§„Ç≥„Éº„É´„Å™„ÇâÂàÜÂ≤ê */
 339 0280 7001      		move.l	 #1, %d0			/* ÈÄÅ‰ø°„Ç≠„É•„Éº„ÇíÊåáÂÆö */
 340 0282 1218      		move.b 	(%a0)+, %d1			/* „Éá„Éº„Çø„Çí„Ç≥„Éî„Éº„Åó„Å¶a0„Çí„Ç§„É≥„ÇØ„É™„É°„É≥„Éà */
 341 0284 4EBA FEFE 		jsr 	INQ				/* INQ„ÇíÂëº„Å≥Âá∫„Åô */
 342 0288 0C40 0000 		cmp 	#0, %d0
 343 028c 6700 0008 		beq 	PUTSTRING_STEP2
 344 0290 5244      		add 	#1, %d4
 345 0292 6000 FFE6 		bra 	PUTSTRING_STEP1			/* „É´„Éº„Éó„ÇíÂõû„Åô */
 346               	
 347               	PUTSTRING_STEP2:
 348 0296 33FC E10C 		move.w 	#0xe10c, USTCNT1		/* USTCNT1„ÇíÊìç‰Ωú„Åó„Å¶ÈÄÅ‰ø°Ââ≤„ÇäËæº„ÅøË®±ÂèØ*/
 348      00FF F900 
 349               	
 350               	PUTSTRING_STEP3:
 351 029e 2004      		move.l 	%d4, %d0			/* sz -> d0 */
 352               	
 353               	END_PUTSTRING:
 354 02a0 4CDF 011E 		movem.l (%sp)+, %d1-%d4/%a0		/* „É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ© */
 355 02a4 4E75      		rts					/* Âëº„Å≥Âá∫„ÅóÂÖÉ„Å∏„ÅÆÂæ©Â∏∞ */
 356               	    
 357               	*******************
 358               	** INTERGET
 359               	** ÂÖ•Âäõ: ch->d1
 360               	**	 data->d2
 361               	******************
 362               	
68K GAS  mon.s 			page 10


 363               	INTERGET:
 364 02a6 48E7 E000 		movem.l	%d0-%d2, -(%sp)		/*„É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø*/
 365 02aa 0C01 0000 		cmpi.b	#0, %d1
 366 02ae 6600 000A 		bne	END_INTERGET		/*ch=0„Å™„Çâ‰Ωï„ÇÇ„Åõ„ÅöÂæ©Â∏∞*/
 367 02b2 7000      		move.l	#0x0, %d0
 368 02b4 2202      		move.l	%d2, %d1
 369 02b6 4EBA FECC 		jsr	INQ			/*OUTQ(1,%d1)„ÇíÂÆüË°å*/
 370               	
 371               	END_INTERGET:
 372 02ba 4CDF 0007 		movem.l	(%sp)+, %d0-%d2		/*„É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ©*/
 373 02be 4E75      		rts
 374               	
 375               	
 376               	************
 377               	** GETSTRING
 378               	** ÂÖ•Âäõ:ch -> d1
 379               	**	p  -> d2 /* „Éá„Éº„ÇøÊõ∏„ÅçËæº„ÅøÂÖà„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ*/
 380               	**	size ->d3 /*Âèñ„ÇäÂá∫„Åô„Éá„Éº„Çø„Çµ„Ç§„Ç∫*/
 381               	** Êàª„ÇäÂÄ§: sz ->d0	
 382               	*************
 383               	
 384               	GETSTRING:
 385 02c0 48E7 7880 		movem.l	%d1-%d4/%a0, -(%sp)		/*„É¨„Ç∏„Çπ„Çø„ÅÆÈÄÄÈÅø*/
 386 02c4 0C01 0000 		cmpi.b	#0, %d1				/*ch„Åå0‰ª•Â§ñ„Å™„Çâ‰Ωï„ÇÇ„Åó„Å™„ÅÑ*/
 387 02c8 6600 0022 		bne	END_GETSTRING
 388 02cc 7800      		move.l	#0, %d4				/*%d4„Çísz„Å®„Åó„Å¶‰ΩøÁî®*/
 389 02ce 2042      		movea.l	%d2, %a0			/*%a0„Çíi„Å®„Åó„Å¶‰ΩøÁî®*/
 390               		
 391               	GETSTRING_LOOP:	
 392 02d0 B843      		cmp	%d3, %d4			/*sz = size„Å™„Çâ„Å∞ÂàÜÂ≤ê*/
 393 02d2 6700 0018 		beq	END_GETSTRING	
 394 02d6 7000      		move.l	#0, %d0				/*Âèó‰ø°„Ç≠„É•„Éº„ÇíÊåáÂÆö*/
 395 02d8 4EBA FEC6 		jsr	OUTQ				/*OUTQ„Å´„Çà„ÇäÂèó‰ø°„Ç≠„É•„Éº„Åã„Çâ„Éá„Éº„ÇøË™≠„ÅøËæº„Åø*/
 396 02dc 0C00 0000 		cmpi.b	#0, %d0				/*OUTQ„ÅåÂ§±Êïó„Å™„Çâ„Å∞ÂàÜÂ≤ê*/
 397 02e0 6700 000A 		beq	END_GETSTRING
 398 02e4 10C1      		move.b	%d1, (%a0)+			/*iÁï™Âú∞„Å´data„Çí„Ç≥„Éî„Éº„Åó„ÄÅi++*/
 399 02e6 5284      		addq.l	#1, %d4				/*sz++*/
 400 02e8 6000 FFE6 		bra	GETSTRING_LOOP
 401               	
 402               	END_GETSTRING:
 403 02ec 2004      		move.l	%d4, %d0			/*sz -> %d0*/
 404 02ee 4CDF 011E 		movem.l	(%sp)+, %d1-%d4/%a0		/*„É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ©*/
 405 02f2 4E75      		rts
 406               	
 407               	**********************
 408               	** RESET_TIMER
 409               	** TCTL„ÇíÂâ≤„ÇäËæº„Åø‰∏çÂèØ„Å´Ë®≠ÂÆö
 410               	**********************
 411               		
 412               	RESET_TIMER:
 413 02f4 33FC 0004 		move.w	#0x0004, TCTL1			/* TCTL„ÇíÂâ≤„ÇäËæº„Åø‰∏çÂèØ*/
 413      00FF F600 
 414 02fc 4E75      		rts
 415               	
 416               	
 417               		
 418               	**********************
68K GAS  mon.s 			page 11


 419               	** SET_TIMER
 420               	** ÂÖ•Âäõ
 421               	** „Çø„Ç§„ÉûÂâ≤„ÇäËæº„ÅøÁô∫ÁîüÂë®Êúüt -> %d1	
 422               	** Ââ≤„ÇäËæº„ÅøÊôÇ„Å´Ëµ∑Âãï„Åô„Çã„É´„Éº„ÉÅ„É≥„ÅÆÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ-> %d2
 423               	**********************
 424               		
 425               	SET_TIMER:
 426 02fe 48E7 6000 		movem.l	%d1-%d2, -(%sp)	/* „É¨„Ç∏„Çπ„ÇøÈÄÄÈÅø */
 427 0302 23C2 0000 		move.l	%d2, task_p	/* ÂÖàÈ†≠„Ç¢„Éâ„É¨„Çπ„Çítask_p„Å∏‰ª£ÂÖ• */
 427      0000 
 428 0308 33F8 00CE 		move.w	206, TPRER1	/* TPRER„Çí206„Å´Ë®≠ÂÆö */
 428      00FF F602 
 429 0310 33C1 00FF 		move.w	%d1, TCMP1	/* Ââ≤„ÇäËæº„ÅøÁô∫ÁîüÂë®Êúü„ÇíTCMP„Å∏ */
 429      F604 
 430 0316 33FC 0015 		move.w	#0x0015, TCTL1	/* TCTL„ÇíÂâ≤„ÇäËæº„ÅøË®±ÂèØ */
 430      00FF F600 
 431 031e 4CDF 0006 		movem.l	(%sp)+, %d1-%d2	/* „É¨„Ç∏„Çπ„Çø„ÅÆÂõûÂæ© */
 432 0322 4E75      		rts
 433               	
 434               	
 435               	****************************
 436               	** CALL_RP
 437               	** „Çø„Ç§„ÉûÂâ≤„ÇäËæº„ÅøÊôÇ„Å´Âá¶ÁêÜ„Åô„Åπ„Åç„É´„Éº„ÉÅ„É≥„ÇíÂëº„Å≥Âá∫„Åô
 438               	****************************
 439               	
 440               	CALL_RP:
 441 0324 48E7 0080 		movem.l	%a0, -(%sp)
 442 0328 2079 0000 		movea.l	(task_p), %a0
 442      0000 
 443 032e 4E90      		jsr	(%a0)		/* task_p„ÅåÊåá„Åô„Ç¢„Éâ„É¨„Çπ„Å∏„Ç∏„É£„É≥„Éó */
 444 0330 4CDF 0100 		movem.l	(%sp)+, %a0
 445 0334 4E75      		rts
 446               	
 447               	skipmt:
 448 0336 4E75      		rts
 449               	
 450               	.end
68K GAS  mon.s 			page 12


DEFINED SYMBOLS
               mon.s:8      .text:0000000000000000 monitor_begin
         equdefs.inc:11     *ABS*:0000000000fff000 REGBASE
         equdefs.inc:12     *ABS*:0000000000d00000 IOBASE
         equdefs.inc:17     *ABS*:0000000000fff300 IVR
         equdefs.inc:18     *ABS*:0000000000fff304 IMR
         equdefs.inc:19     *ABS*:0000000000fff30c ISR
         equdefs.inc:20     *ABS*:0000000000fff310 IPR
         equdefs.inc:25     *ABS*:0000000000fff600 TCTL1
         equdefs.inc:26     *ABS*:0000000000fff602 TPRER1
         equdefs.inc:27     *ABS*:0000000000fff604 TCMP1
         equdefs.inc:28     *ABS*:0000000000fff608 TCN1
         equdefs.inc:29     *ABS*:0000000000fff60a TSTAT1
         equdefs.inc:34     *ABS*:0000000000fff900 USTCNT1
         equdefs.inc:35     *ABS*:0000000000fff902 UBAUD1
         equdefs.inc:36     *ABS*:0000000000fff904 URX1
         equdefs.inc:37     *ABS*:0000000000fff906 UTX1
         equdefs.inc:42     *ABS*:0000000000d0002f LED7
         equdefs.inc:43     *ABS*:0000000000d0002d LED6
         equdefs.inc:44     *ABS*:0000000000d0002b LED5
         equdefs.inc:45     *ABS*:0000000000d00029 LED4
         equdefs.inc:46     *ABS*:0000000000d0003f LED3
         equdefs.inc:47     *ABS*:0000000000d0003d LED2
         equdefs.inc:48     *ABS*:0000000000d0003b LED1
         equdefs.inc:49     *ABS*:0000000000d00039 LED0
         equdefs.inc:54     *ABS*:0000000000000001 SYSCALL_NUM_GETSTRING
         equdefs.inc:55     *ABS*:0000000000000002 SYSCALL_NUM_PUTSTRING
         equdefs.inc:56     *ABS*:0000000000000003 SYSCALL_NUM_RESET_TIMER
         equdefs.inc:57     *ABS*:0000000000000004 SYSCALL_NUM_SET_TIMER
         equdefs.inc:65     .data:0000000000000000 TTC
         equdefs.inc:72     .bss:0000000000000000 BUF
         equdefs.inc:75     .bss:0000000000000100 USR_STK
         equdefs.inc:77     .bss:0000000000004100 USR_STK_TOP
         equdefs.inc:81     .bss:0000000000004100 Queue0
         equdefs.inc:82     .bss:0000000000004212 Queue1
         equdefs.inc:85     *ABS*:0000000000000000 BF_START
         equdefs.inc:86     *ABS*:00000000000000ff BF_END
         equdefs.inc:87     *ABS*:0000000000000100 top
         equdefs.inc:88     *ABS*:0000000000000104 out
         equdefs.inc:89     *ABS*:0000000000000108 in
         equdefs.inc:90     *ABS*:000000000000010c bottom
         equdefs.inc:91     *ABS*:0000000000000110 s
               mon.s:12     .bss:0000000000004324 SYS_STK
               mon.s:15     .bss:0000000000008324 SYS_STK_TOP
               mon.s:18     .bss:0000000000008324 task_p
               mon.s:27     .text:0000000000000000 boot
               mon.s:71     .text:0000000000000064 uart1_interrupt
               mon.s:96     .text:000000000000009c timer_interrupt
               mon.s:153    .text:0000000000000118 Init_Q
               mon.s:116    .text:00000000000000bc SYSTEM_CALL
               mon.s:79     .text:000000000000007e uart1_interrupt_receive
               mon.s:290    .text:0000000000000224 INTERPUT
               mon.s:87     .text:0000000000000096 uart1_interrupt_end
               mon.s:363    .text:00000000000002a6 INTERGET
               mon.s:103    .text:00000000000000ba timer_interrupt_end
               mon.s:440    .text:0000000000000324 CALL_RP
               mon.s:121    .text:00000000000000ca SYSTEM_CALL1
68K GAS  mon.s 			page 13


               mon.s:447    .text:0000000000000336 skipmt
               mon.s:128    .text:00000000000000e0 SYSTEM_CALL2
               mon.s:384    .text:00000000000002c0 GETSTRING
               mon.s:145    .text:0000000000000112 SYSTEM_CALL_FINISH
               mon.s:134    .text:00000000000000f2 SYSTEM_CALL3
               mon.s:327    .text:0000000000000262 PUTSTRING
               mon.s:140    .text:0000000000000104 SYSTEM_CALL4
               mon.s:412    .text:00000000000002f4 RESET_TIMER
               mon.s:425    .text:00000000000002fe SET_TIMER
               mon.s:158    .text:0000000000000122 Init_Q0
               mon.s:169    .text:0000000000000148 Init_Q1
               mon.s:187    .text:000000000000016e SelectQueue
               mon.s:192    .text:0000000000000182 End_SelectQueue
               mon.s:199    .text:0000000000000184 INQ
               mon.s:235    .text:00000000000001bc PUT_BUF
               mon.s:216    .text:00000000000001a0 OUTQ
               mon.s:263    .text:00000000000001f0 GET_BUF
               mon.s:254    .text:00000000000001ee END_PUT_BUF
               mon.s:247    .text:00000000000001e2 STEP1_PUT_BUF
               mon.s:250    .text:00000000000001e8 STEP2_PUT_BUF
               mon.s:283    .text:0000000000000222 END_GET_BUF
               mon.s:275    .text:0000000000000216 STEP1_GET_BUF
               mon.s:279    .text:000000000000021c STEP2_GET_BUF
               mon.s:311    .text:000000000000025a END_INTERPUT
               mon.s:307    .text:0000000000000250 OUTQ_FAIL
               mon.s:353    .text:00000000000002a0 END_PUTSTRING
               mon.s:350    .text:000000000000029e PUTSTRING_STEP3
               mon.s:336    .text:000000000000027a PUTSTRING_STEP1
               mon.s:347    .text:0000000000000296 PUTSTRING_STEP2
               mon.s:371    .text:00000000000002ba END_INTERGET
               mon.s:402    .text:00000000000002ec END_GETSTRING
               mon.s:391    .text:00000000000002d0 GETSTRING_LOOP

UNDEFINED SYMBOLS
start
